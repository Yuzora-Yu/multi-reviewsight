<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>だれでもレビュー｜ログイン / 会員登録</title>

  <base href="/multi-reviewsight/">

  <script src="https://cdn.tailwindcss.com"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <link rel="stylesheet" href="css/style.css?v=2025-10-03" />

  <script defer src="js/common.js?v=2025-10-03"></script>
  <script defer src="js/auth.js?v=2025-10-03"></script>
</head>


<body class="bg">
  <!-- ヘッダー -->
  <header>
    <div class="mx flex items-center justify-between">
      <a href="./" class="brand text-xl">だれでもレビュー</a>
      <nav class="flex gap-2">
        <a href="post.html" class="btn-outline btn-xs">レビュー投稿</a>
        <a href="my.html" class="btn-outline btn-xs">マイページ</a>
      </nav>
    </div>
  </header>

  <main class="mx space-y-6" style="padding-top:24px;padding-bottom:48px">
    <!-- 状態表示 -->
    <section class="block">
      <h2 class="sec">会員登録 / ログイン</h2>
      <p class="meta mt-1">登録は無料。確認メールのリンクから「レビュアーネーム」を設定して完了です。</p>

      <div id="authState" class="mt-3 text-sm"></div>

      <div class="mt-4 flex gap-8 flex-wrap items-center">
        <button id="openSignup" class="btn">新規会員登録</button>
        <button id="openLogin" class="btn-outline">メールでログイン</button>
        <button id="logoutBtn" class="btn-outline hidden">ログアウト</button>
      </div>
    </section>

    <!-- 本登録（メールリンクで戻ってきたときに表示） -->
    <section id="completeSection" class="block hidden">
      <h2 class="sec">本登録</h2>
      <p class="meta mt-1">以下のメールアドレスで登録します。レビュアーネームを入力して「本登録」を押してください。</p>
      <form id="completeForm" class="mt-3 space-y-3" autocomplete="off">
        <div>
          <label class="label">メールアドレス</label>
          <input id="completeEmail" class="inp" disabled />
        </div>
        <div>
          <label class="label">レビュアーネーム（公開名）</label>
          <input id="completeName" class="inp" placeholder="例：ゆぞら" required maxlength="32" />
        </div>
        <button class="btn">本登録</button>
      </form>
    </section>

    <div class="text-center">
      <a href="./" class="btn-outline">トップへ戻る</a>
    </div>
  </main>

  <!-- ========== 登録/ログインモーダル ========== -->
  <div id="authModal" class="fixed inset-0 hidden items-center justify-center"
       style="background:rgba(0,0,0,.45);backdrop-filter:blur(6px);z-index:50">
    <div class="modal card" style="width:min(560px,94vw);padding:20px">
      <div class="flex justify-between items-center w-full">
        <h3 id="modalTitle" class="sec">新規会員登録</h3>
        <button id="closeModal" class="btn-outline btn-xs">閉じる</button>
      </div>

      <!-- サインアップ -->
      <form id="signupForm" class="mt-4 grid gap-3">
        <div>
          <label class="label">メールアドレス</label>
          <input id="suEmail" type="email" class="inp" placeholder="you@example.com" required />
        </div>
        <div>
          <label class="label">パスワード</label>
          <input id="suPassword" type="password" class="inp" placeholder="8文字以上" minlength="8" required />
        </div>
        <div>
          <label class="label">パスワード（確認）</label>
          <input id="suPassword2" type="password" class="inp" minlength="8" required />
        </div>
        <button class="btn" id="signupBtn" type="submit">仮登録メールを送信</button>
        <p class="meta">※確認メールのリンクから本登録に進みます。</p>
      </form>

      <!-- ログイン -->
      <form id="loginForm" class="mt-4 grid gap-3 hidden">
        <div>
          <label class="label">メールアドレス</label>
          <input id="liEmail" type="email" class="inp" required />
        </div>
        <div>
          <label class="label">パスワード</label>
          <input id="liPassword" type="password" class="inp" required />
        </div>
        <button class="btn" id="loginBtn" type="submit">ログイン</button>
      </form>
    </div>
  </div>
</body>
</html>
